<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Konfirmasi Kehadiran</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: system-ui, -apple-system, sans-serif;
      font-size: 10px;
      margin: 0;
      padding: 2px;
      background: transparent;
      color: #f7f2f2;
    }
    .judul {
      text-align: center;
      margin: 0 0 0px;
    }
    .judul h1 {
      font-size: 16px;
      margin: 0;
      color: #1a237e;
    }
    .judul h2 {
      font-size: 14px;
      margin: 0px 0;
      color: #0d47a1;
    }
    .judul h3 {
      font-size: 10px;
      margin: 0px 0;
      color: black;
    }
    form {
      background: #fff;
      padding: 10px;
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,.8);
      position: relative;
    }
    input, select, button {
      width: 100%;
      padding: 7px;
      font-size: 10px;
      margin-bottom: 6px;
      border: 1px solid #bbb;
      border-radius: 4px;
    }
    button {
      background: #007bff;
      color: #fff;
      border: none;
      cursor: pointer;
    }
    button:active {
      background: #0056b3;
    }
    
    /* Loading Bar */
    #loadingBar {
      display: none;
      height: 3px;
      background: #e0e0e0;
      border-radius: 2px;
      overflow: hidden;
      margin-top: 4px;
    }
    #progressBar {
      height: 100%;
      background: #007bff;
      width: 0;
      transition: width .3s;
    }
    
    /* Blink Message Styles */
    .message {
      display: none;
      text-align: center;
      padding: 10px;
      margin: 10px 0;
      border-radius: 4px;
      font-weight: bold;
      font-size: 12px;
      animation: blink 1s infinite;
    }
    .message.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    .message.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    
    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0.3; }
    }
    
    /* Searchable Dropdown Styles */
    .searchable-select {
      position: relative;
      margin-bottom: 6px;
    }
    .searchable-select input {
      width: 100%;
      margin-bottom: 0;
    }
    .dropdown-list {
      display: none;
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      max-height: 150px;
      overflow-y: auto;
      background: white;
      border: 1px solid #bbb;
      border-top: none;
      border-radius: 0 0 4px 4px;
      z-index: 1000;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .dropdown-list.active {
      display: block;
    }
    .dropdown-item {
      padding: 7px;
      cursor: pointer;
      color: #333;
      border-bottom: 1px solid #eee;
    }
    .dropdown-item:hover {
      background: #007bff;
      color: white;
    }
    .dropdown-item.no-result {
      color: #999;
      cursor: default;
    }
    .dropdown-item.no-result:hover {
      background: white;
      color: #999;
    }
  </style>
</head>
<body>

<div class="judul">
  <h2>Seminar dan Technical Assistance</h2>
  <h3>BPR/BPRS Anggota Apex Bank Jateng</h3>
  <h3>Semarang, 02 Februari 2026</h3><br>
</div>

<form id="Form">
  <input name="PesertaNama" required placeholder="Peserta (Nama)">
  <input type="tel" name="PesertaNoWA" required placeholder="Peserta (NoWA), contoh:85727051675">
  
  <!-- Searchable NamaBPR -->
  <div class="searchable-select">
    <input type="text" id="NamaBPRInput" placeholder="Cari dan pilih NamaBPR..." autocomplete="off" required>
    <input type="hidden" name="NamaBPR" id="NamaBPRHidden">
    <div class="dropdown-list" id="BPRDropdown"></div>
  </div>

  <select name="AnggotaApex" required>
    <option value="">-- AnggotaApex --</option>
    <option>Anggota Apex</option>
    <option>Tidak Anggota Apex</option>
  </select>

  <input name="ContactNama" placeholder="Contact Person (Nama)">
  <input type="tel" name="ContactNoWA" placeholder="Contact Person (NoWA), contoh:85727051675">

  <!-- Message Containers -->
  <div id="successMessage" class="message success">✅ Data berhasil dikirim!</div>
  <div id="errorMessage" class="message error">❌ Terjadi kesalahan saat mengirim data!</div>

  <button type="submit">Kirim</button>
  <div id="loadingBar"><div id="progressBar"></div></div>
</form>

<script>
  // Data NamaBPR
  const bprList = [
"PT. BPR Arum Mandiri Kenanga",
"PT. BPR Bina Arta Swadaya Yogyakarta",
"PT. BPR Nusantara Artha Makmur",
"PT. BPR Arga Tata",
"PT. BPR Kartikaartha Kencanajaya",
"PT. BPR Swadharma Bangun Artha",
"PT. BPR Swadharma Artha Nusa",
"PT. BPR Artha Parama",
"PT. BPR Profidana Paramitra",
"PT. BPR Ambarketawang Persada",
"PT. BPR Kurnia Sewon",
"PT. BPR Nusamba Banguntapan",
"PT. BPR Chandra Muktiartha",
"PD. BPR Bank Bantul",
"PT. BPR Artajaya Bhaktimulia",
"PT. BPR Gamping Artha Raya",
"PT BPR Nusumma Jogja",
"PT. BPR Sindu Adi",
"PT. BPR Artha Sumber Arum",
"PT. BPR Restu Mandiri Makmur",
"PT. BPR Wijayamulya Santosa",
"PT. BPR Dewa Arthaka Mulya",
"PT. BPR Danamas Prima",
"PT. BPR Arta Yogyakarta",
"PT. BPR Dana Berkah Pusakatama",
"PT. BPR Alto Makmur",
"PT. BPR Bhumikarya Pala",
"PT. BPR Mlati Pundi Artha",
"PT. BPR Berlian Bumi Arta",
"PT. BPR Karangwaru Pratama",
"PT. BPR Arta Agung",
"PT. BPR Panca Arta Monjali",
"PT. BPR Universitas Gajah Mada",
"PT. BPR Danagung Abadi",
"PT. BPR Natasha Bintang Anugrah",
"PT. BPR Artha Mlatiindah",
"PT. BPR Danagung Bakti",
"PT. BPR Danagung Ramulti",
"PT. BPR Shinta Daya",
"PT. BPR Bhakti Daya Ekonomi",
"PD. BPR Bank Sleman",
"PT. BPR Arum Mandiri Melati",
"PT. BPR Ukabima Nindya Raharja",
"PD. BPR Bank Daerah Gunungkidul",
"PT. BPR Shinta Putra Pengasih",
"PT. BPR Nusamba Temon",
"PD. BPR BP Kulon Progo",
"PT. BPR Lestari Darmo Mulyo",
"PT. BPR Walet Jaya Abadi",
"PT. BPR Mataram Mitra Manunggal",
"PT. BPR Artha Berkah Cemerlang",
"PT. BPR Madani Sejahtera Abadi",
"PD. BPR Bank Jogja Kota Yogyakarta"
  ];

  // Searchable Dropdown Logic
  const namaBPRInput = document.getElementById('NamaBPRInput');
  const namaBPRHidden = document.getElementById('NamaBPRHidden');
  const dropdown = document.getElementById('BPRDropdown');
  
  function renderDropdown(filter = '') {
    dropdown.innerHTML = '';
    const filtered = bprList.filter(item => 
      item.toLowerCase().includes(filter.toLowerCase())
    );
    
    if (filtered.length === 0) {
      const div = document.createElement('div');
      div.className = 'dropdown-item no-result';
      div.textContent = 'Tidak ada hasil';
      dropdown.appendChild(div);
    } else {
      filtered.forEach(item => {
        const div = document.createElement('div');
        div.className = 'dropdown-item';
        div.textContent = item;
        div.onclick = () => {
          namaBPRInput.value = item;
          namaBPRHidden.value = item;
          dropdown.classList.remove('active');
        };
        dropdown.appendChild(div);
      });
    }
  }
  
  namaBPRInput.addEventListener('focus', () => {
    renderDropdown(namaBPRInput.value);
    dropdown.classList.add('active');
  });
  
  namaBPRInput.addEventListener('input', (e) => {
    renderDropdown(e.target.value);
    dropdown.classList.add('active');
    // Reset hidden input saat mengetik manual
    namaBPRHidden.value = e.target.value;
  });
  
  // Tutup dropdown saat klik di luar
  document.addEventListener('click', (e) => {
    if (!e.target.closest('.searchable-select')) {
      dropdown.classList.remove('active');
    }
  });

  // Form Submit Logic
  const scriptURL = 'https://script.google.com/macros/s/AKfycbwftKAFaotp8Kgi89VGV5sKbNgMRkqDnHZE8b2nDUqYCba3lqMUPC8KBzVnaAAcqyWv/exec';
  const form = document.getElementById('Form');
  const loadingBar = document.getElementById('loadingBar');
  const progressBar = document.getElementById('progressBar');
  const successMsg = document.getElementById('successMessage');
  const errorMsg = document.getElementById('errorMessage');

  form.addEventListener('submit', e => {
    e.preventDefault();
    
    // Sembunyikan pesan sebelumnya
    successMsg.style.display = 'none';
    errorMsg.style.display = 'none';
    
    loadingBar.style.display = 'block';
    progressBar.style.width = '30%';
    
    fetch(scriptURL, { method: 'POST', body: new FormData(form) })
      .then(() => {
        progressBar.style.width = '100%';
        setTimeout(() => {
          loadingBar.style.display = 'none';
          progressBar.style.width = '0%';
          successMsg.style.display = 'block';
          form.reset();
          namaBPRHidden.value = '';
          
          // Hilangkan pesan setelah 5 detik
          setTimeout(() => {
            successMsg.style.display = 'none';
          }, 5000);
        }, 300);
      })
      .catch(() => {
        loadingBar.style.display = 'none';
        progressBar.style.width = '0%';
        errorMsg.style.display = 'block';
        
        // Hilangkan pesan setelah 5 detik
        setTimeout(() => {
          errorMsg.style.display = 'none';
        }, 5000);
      });
  });
</script>
</body>
</html>
